<!DOCTYPE html>
<head>
  <!-- jQuery packaging changed for 2.1.0, so try to load both paths, one will work. -->
  <script src="../../bower_components/jquery/dist/jquery.js"></script>
  <script src="../../bower_components/jquery/jquery.js"></script>
  <script src="../../bower_components/raphael/raphael-min.js"></script>
  <script src="../../morris.js"></script>
  <link rel="stylesheet" href="../../morris.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <style>
    body {
      padding: 0;
      margin: 0;
      background-color: white;
    }
    #chart {
      width: 500px;
      height: 300px;
    }
  </style>
  <script>
    function bridge(e) {
      window.alert(JSON.stringify(e));
    }
    window.snapshot = function () {
      bridge({ fn: "snapshot" });
    };
    window.mousemove = function (x, y) {
      bridge({ fn: "mousemove", x: x, y: y });
    };




  </script>
</head>
<body>

    <nav>
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
          <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true">Home</a>
          <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false">Profile</a>
          <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-contact" role="tab" aria-controls="nav-contact" aria-selected="false">Contact</a>
        </div>
      </nav>
      <div class="tab-content" id="nav-tabContent">
        <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">...</div>
        <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">one</div>
        <div class="tab-pane fade" id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab">two</div>
      </div>




      <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

</body>




<script>

setInterval(() => {
        var rolename = $('#unique_role').val();
        // alert(rolename);
        var mobileprint = localStorage.getItem('mobileprint');
        if (rolename == 1) {
            //    alert(rolename);

            $.ajax({

                type: 'POST',

                url: '/mobile-print',

                data: {
                    "_token": "{{ csrf_token() }}",
                },

                success: function(data) {
                    if (mobileprint == null) {
                        mobileprint = 0;
                    }


                }
            });
        }
    }, 3000);

</script>

<section>


    <div class="row justify-content-center">
        <div class="col-md-5 printableArea1" style="width:45%;">
            <div class="card shadow">
                <div class="card-header">
                    <h4><strong style="font-size:17px;font-weight:bold;">Kitchen Details</strong></h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-12" style="text-align:center;">
                            <strong style="font-size:17px;font-weight:bold;">Main Dish</strong>
                            <div class="row justify-content-center">
                                <strong style="font-size:17px;font-weight:bold;"><h5 class="font-weight-bold mt-1">Order Number ---  Item</h5></strong>
                            </div>

                            <div class="row mt-1 justify-content-center">
                                <strong style="font-size:17px;font-weight:bold;"><h5 class="font-weight-bold mt-1">Table Name ---  Item</h5></strong>
                            </div>
                        </div>

                        <div class="col-md-12">
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th><strong style="font-size:16px;font-weight:bold;">Item Name</strong></th>
                                            <th><strong style="font-size:16px;font-weight:bold;">Counting Unit Name</strong></th>
                                            <th><strong style="font-size:17px;font-weight:bold;">Order Quantity</strong></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                <td><strong style="font-size:16px;font-weight:bold;">Item</strong></td>
                                                <td><strong style="font-size:16px;font-weight:bold;">Item</strong></td>
                                                <td><strong style="font-size:17px;font-weight:bold;">Item</strong></td>
                                            </tr>
                                </tbody>
                                        <tr>
                                            <th class="text-danger font-weight-bold">Notes</th>
                                            <td class="text-danger font-weight-bold">Item</td>
                                            <td class="text-danger" colspan="3">Item</td>
                                        </tr>
                                </table>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>


    <div class="row justify-content-center">
        <div class="col-md-5 printableArea" style="width:100%;" id="printableArea">
            <div class="card card-body">
                <div class="row" style="margin:10px">
                    <div class="col-md-12">
                    <div style="text-align:center;">
                        <address>
                            <b style="font-size:17px;">Upper Deck&nbsp;&nbsp;(<span class="text-danger">Kitchen</span>)</b><br>
                                <b style="font-size:17px;">Bar & Restaurant</b>

                        </address>
                    </div>
                    <div class="pull-right text-left" style="margin-top:20px;">
                            <b style="font-size:16px;">Waiter Name : ${data.waiter}</b><br>
                            <b style="font-size:16px;">Date : <i class="fa fa-calendar"></i> ${data.date}</b><br>
                            <b style="font-size:16px;">Table-Number : ${data.tableno.table.table_number}</b><br>
                        </font>
                    </div>
                </div>

                <div class="col-md-12" style="margin-top:12px;">
                    <div class="table-responsive" style="clear: both;">
                        <table class="table">
                            <thead>
                                <tr>
                                    <td>Menu Name</td>
                                    <td>Option & Size</td>
                                    <td >Qty</td>
                                </tr>
                            </thead>
                            <tbody>
                                 ${pending}
                            </tbody>
                        </table>
                        <h6 class=" font-weight-bold" style="text-align:center;">***************</h6>
                    </div>
                </div>
            </div>
                </div>
            </div>
                </div>



                <div class="col-md-5 printableArea2" style="width:45%;">
                    <div class="card shadow">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-12 text-center">
                                    <div class="table-responsive">
                                        <table class="table">
                                            <thead>
                                                <tr>
                                                    <th><strong style="font-size:16px;font-weight:bold;">Item Name</strong></th>
                                                    <th><strong style="font-size:16px;font-weight:bold;">Option Name</strong></th>
                                                    <th><strong style="font-size:16px;font-weight:bold;">Qty</strong></th>
                                                    <th><strong style="font-size:16px;font-weight:bold;">Subtotal</strong></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                    <tr>
                                                        <td><strong style="font-size:16px;font-weight:bold;"></strong></td>
                                                        <td><strong style="font-size:16px;font-weight:bold;"></strong></td>
                                                        <td><strong style="font-size:16px;font-weight:bold;"></strong></td>
                                                        <td><strong style="font-size:16px;font-weight:bold;"></strong></td>
                                                    </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>







<script>


<script>
    setInterval(() => {
        var rolename = $('#unique_role').val();
        // alert(rolename);
        var mobileprint = localStorage.getItem('mobileprint');
        // Casher Main Dish
        if (rolename == 2) {
            //    alert(rolename);

            $.ajax({

                type: 'POST',

                url: '/mobile-print',

                data: {
                    "_token": "{{ csrf_token() }}",
                },

                success: function(data) {
                    if (mobileprint == null) {
                        mobileprint = 0;
                    }

                    if (data) {
                            if (data.order_table.id > mobileprint) {
                                console.log('Drink Data is',data);
                                        var items = ``;
                                        var jj = 0;





                               var pending_items = ``;
                                        var jj = 0;
                                        $.each(data.shop_lists, function(i, shopList) {
                                            if (shopList.print == 0 && shopList.voucher_id ==
                                                null) {
                                                $.each(shopList.option, function(i, option) {
                                                    if (option.menu_item.meal_id == 1) {
                                                        pending_items += `
                                                        <tr style="width:100%; font-size:12px">
                                                            <td class="text-danger font-weight-bold"><b>${option.name}</b></td>
                                                            <td class="text-danger font-weight-bold"><b>${option.name}</b></td>
                                                            <td class="text-danger font-weight-bold"><b>${option.pivot.quantity}</b></td>
                                                        </tr>
                                                        <tr style="width:100%; font-size:12px">
                                                        <th class="text-danger font-weight-bold">Notes</th>
                                                        <td class="text-danger" colspan="3">${option.pivot.note}</td>
                                                        </tr>
                                                        `;
                                                    }
                                                });
                                            }
                                            jj = jj + 1;
                                        });

                                        var pending = " ";
                                        $.each(data.shop_lists, function(i, shopList) {
                                            pending = `<div class="row justify-content-center">
                                                <div class="col-md-5 printableArea" style="width:100%;" id="printableArea">
                                                    <div class="card card-body">
                                                        <div class="row" style="margin:10px">
                                                            <div class="col-md-12">
                                                            <div style="text-align:center;">
                                                                <address>
                                                                    <b style="font-size:17px;">Upper Deck&nbsp;&nbsp;(<span class="text-danger">Kitchen</span>)</b><br>
                                                                        <b style="font-size:17px;">Bar & Restaurant</b>

                                                                </address>
                                                            </div>
                                                            <div class="pull-right text-left" style="margin-top:20px;">
                                                                    <b style="font-size:16px;">Waiter Name : ${data.waiter}</b><br>
                                                                    <b style="font-size:16px;">Date : <i class="fa fa-calendar"></i> ${data.date}</b><br>
                                                                    <b style="font-size:16px;">Table-Number : ${data.tableno.table.table_number}</b><br>
                                                                </font>
                                                            </div>
                                                        </div>

                                                <div class="col-md-12" style="margin-top:12px;">
                                                    <div class="table-responsive" style="clear: both;">
                                                        <table class="table">
                                                            <thead>
                                                                <tr>
                                                                    <td>Menu Name</td>
                                                                    <td>Option & Size</td>
                                                                    <td >Qty</td>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                ${pending_items}
                                                            </tbody>
                                                        </table>
                                                        <h6 class=" font-weight-bold" style="text-align:center;">***************</h6>
                                                    </div>
                                                </div>
                                            </div>
                                                </div>
                                            </div>
                                                </div>`;
                                                });
                                                $('#mobileprint').html(pending);
                                                var setItem = localStorage.setItem('mobileprint', JSON.stringify(
                                                    data
                                                    .order_table
                                                    .id));
                                                var printContent = $('#mobileprint')[0];
                                                var WinPrint = window.open('', '', 'width=900,height=650');
                                                WinPrint.document.write('<html><head><title>Print Voucher</title>');
                                                WinPrint.document.write(
                                                    '<link rel="stylesheet" type="text/css" href="css/style.css">'
                                                );
                                                WinPrint.document.write(
                                                    '<link rel="stylesheet" type="text/css" media="print" href="css/print.css">'
                                                );
                                                WinPrint.document.write('</head><body >');
                                                WinPrint.document.write(printContent.innerHTML);
                                                WinPrint.document.write('</body></html>');

                                                // WinPrint.document.write(html);
                                                WinPrint.focus();
                                                WinPrint.print();
                                                WinPrint.document.close();
                                                WinPrint.close();
                                                            }
                                            }
                                            updatePrintStatus();
                                        }

                                }
        // Casher Drink
        if (rolename == 4) {
            //    alert(rolename);

            $.ajax({

                type: 'POST',

                url: '/mobile-print',

                data: {
                    "_token": "{{ csrf_token() }}",
                },

                success: function(data) {
                    if (mobileprint == null) {
                        mobileprint = 0;
                    }

                    if (data) {
                        if (data.order_table.id > mobileprint) {
                            console.log('Drink data is',data);
                            var pending_items = ``;

                            $.each(data.shop_lists, function(i, shopList) {
                                if (shopList.print == 0 && shopList.voucher_id == null) {
                                    $.each(shopList.option, function(i, option) {
                                        if(option.menu_item.meal_id == 2){
                                        pending_items += `
                                    <tr style="width:100%; font-size:12px">
                                        <td><b>${option.name}</b></td>
                                        <td><b>${option.name}</b></td>
                                        <td><b>${option.pivot.quantity}</b></td>
                                    </tr>`;
                                        }

                                    });
                                }
                            });

                            var pending = " ";
                            $.each(data.shop_lists, function(i, shopList) {
                                $.each(shopList.option, function(i, option) {
                                    if(option.menu_item.meal_id === 2){
                                    pending = `<div class="row justify-content-center">
                                    <div class="col-md-5 printableArea" style="width:100%;" id="printableArea">
                                        <div class="card card-body">
                                            <div class="row" style="margin:10px">
                                                <div class="col-md-12">
                                                <div style="text-align:center;">
                                                    <address>
                                                        <b style="font-size:17px;">Upper Deck&nbsp;&nbsp;(<span class="text-danger">Kitchen</span>)</b><br>
                                                            <b style="font-size:17px;">Bar & Restaurant</b>

                                                    </address>
                                                </div>
                                                <div class="pull-right text-left" style="margin-top:20px;">
                                                        <b style="font-size:16px;">Waiter Name : ${data.waiter}</b><br>
                                                        <b style="font-size:16px;">Date : <i class="fa fa-calendar"></i> ${data.date}</b><br>
                                                        <b style="font-size:16px;">Table-Number : ${data.tableno.table.table_number}</b><br>
                                                    </font>
                                                </div>
                                            </div>

                                            <div class="col-md-12" style="margin-top:12px;">
                                                <div class="table-responsive" style="clear: both;">
                                                    <table class="table">
                                                        <thead>
                                                            <tr>
                                                                <td>Menu Name</td>
                                                                <td>Option & Size</td>
                                                                <td >Qty</td>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                             ${pending_items}
                                                        </tbody>
                                                    </table>
                                                    <h6 class=" font-weight-bold" style="text-align:center;">***************</h6>
                                                </div>
                                            </div>
                                        </div>
                                            </div>
                                        </div>
                                            </div>`;
                            }
                        })
                            });
                            $('#mobileprint').html(pending);
                            var setItem = localStorage.setItem('mobileprint', JSON.stringify(data
                                .order_table
                                .id));
                            var printContent = $('#mobileprint')[0];
                            var WinPrint = window.open('', '', 'width=900,height=650');
                            WinPrint.document.write('<html><head><title>Print Voucher</title>');
                            WinPrint.document.write(
                                '<link rel="stylesheet" type="text/css" href="css/style.css">'
                            );
                            WinPrint.document.write(
                                '<link rel="stylesheet" type="text/css" media="print" href="css/print.css">'
                            );
                            WinPrint.document.write('</head><body >');
                            WinPrint.document.write(printContent.innerHTML);
                            WinPrint.document.write('</body></html>');

                            // WinPrint.document.write(html);
                            WinPrint.focus();
                            WinPrint.print();
                            WinPrint.document.close();
                            WinPrint.close();
                        }
                    }
                    updatePrintStatus();
                }
            });
        }
    }, 3000);


    function updatePrintStatus(){
        var printStatus = 0;
        $.ajax({
            url: "/printStatusUpdate",
            method: 'POST',
            data: {
                "_token": "{{ csrf_token() }}",
                print: printStatus
            },
        })
    }


</script>








</section>
